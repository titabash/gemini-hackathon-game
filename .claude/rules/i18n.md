# Internationalization (i18n) Policy

**MANDATORY**: すべてのユーザー向けテキストは多言語対応必須。

## 基本原則

- すべてのUI文言は翻訳キーを使用
- ハードコードされたテキストは禁止
- デフォルト言語: 英語（en）
- サポート言語: 英語（en）、日本語（ja）

## slang を使用

このプロジェクトでは **slang** パッケージを使用：

- 型安全な翻訳アクセス
- コンパイル時の翻訳キー検証
- JSON ベースの翻訳ファイル
- 自動コード生成

## 翻訳ファイルの場所

```
frontend/packages/core/i18n/lib/translations/
├── en.i18n.json       # 英語（ベース言語）
└── ja.i18n.json       # 日本語
```

## 使用方法

### 翻訳の追加

1. **JSON ファイルに追加**:
```json
// en.i18n.json
{
  "common": {
    "save": "Save",
    "cancel": "Cancel",
    "loading": "Loading..."
  },
  "auth": {
    "login": "Login",
    "email": "Email",
    "password": "Password"
  }
}

// ja.i18n.json
{
  "common": {
    "save": "保存",
    "cancel": "キャンセル",
    "loading": "読み込み中..."
  },
  "auth": {
    "login": "ログイン",
    "email": "メールアドレス",
    "password": "パスワード"
  }
}
```

2. **コード生成**:
```bash
make frontend-generate
```

3. **コードで使用**:
```dart
import 'package:core_i18n/generated/strings.g.dart';

// Widget内で使用
Text(t.common.save)
Text(t.auth.login)
Text(t.common.loading)
```

### パラメータ付き翻訳

```json
// en.i18n.json
{
  "welcome": {
    "message": "Hello, {name}!"
  }
}

// ja.i18n.json
{
  "welcome": {
    "message": "こんにちは、{name}さん！"
  }
}
```

```dart
Text(t.welcome.message(name: userName))
```

### 複数形対応

```json
// en.i18n.json
{
  "items": {
    "count": {
      "zero": "No items",
      "one": "1 item",
      "other": "{count} items"
    }
  }
}
```

```dart
Text(t.items.count(count: itemCount))
```

## 言語切り替え

```dart
import 'package:core_i18n/providers/locale_provider.dart';

// Riverpod Provider で言語切り替え
final localeNotifier = ref.read(localeNotifierProvider.notifier);

// 日本語に切り替え
localeNotifier.changeLocale(AppLocale.ja);

// トグル
localeNotifier.toggleLocale();

// 現在の言語を取得
final currentLocale = ref.watch(localeNotifierProvider);
```

## 禁止パターン

```dart
// ❌ ハードコードされたテキスト
Text('Save')
Text('ログイン')
ElevatedButton(child: Text('Submit'), ...)

// ✅ 翻訳キーを使用
Text(t.common.save)
Text(t.auth.login)
ElevatedButton(child: Text(t.common.submit), ...)
```

## 例外

以下の場合のみハードコードテキスト許可：

1. **技術的な定数**: API エンドポイント、環境変数名
2. **ログメッセージ**: 開発者向けログ（ユーザーに表示されない）
3. **テストデータ**: テストコード内のサンプルデータ

```dart
// ✅ 許可される例外
const apiEndpoint = '/api/users';  // 技術的定数
logger.debug('User authenticated');  // 開発者向けログ
final testUser = User(name: 'Test User');  // テストデータ
```

## 翻訳の整理

翻訳は機能別に階層化：

```json
{
  "app": {
    "title": "...",
    "name": "..."
  },
  "common": {
    "save": "...",
    "cancel": "...",
    "loading": "..."
  },
  "auth": {
    "login": "...",
    "signup": "...",
    "logout": "..."
  },
  "dashboard": {
    "title": "...",
    "welcome": "..."
  },
  "settings": {
    "language": "...",
    "theme": "..."
  }
}
```

## ベストプラクティス

1. **一貫性のあるキー命名**: `camelCase` を使用
2. **階層構造**: 関連する翻訳をグループ化
3. **短く明確**: キー名は意味が明確で短く
4. **パラメータの活用**: 動的な値はパラメータで渡す
5. **フォールバック**: 英語（en）をベース言語として完全に記述

## コマンド

```bash
# 翻訳ファイル編集後、コード生成
make frontend-generate

# または直接
cd frontend && flutter pub run build_runner build
```

## Enforcement

この i18n ポリシーは **NON-NEGOTIABLE**。ハードコードされたユーザー向けテキストは却下される。
